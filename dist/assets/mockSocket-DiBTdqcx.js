class n{constructor(){this.connected=!1,this.listeners={}}on(o,s){this.listeners[o]||(this.listeners[o]=[]),this.listeners[o].push(s),o==="notification"&&setTimeout(()=>{this.simulateNotification()},5e3)}emit(o,s){console.log(`[MockSocket] Emitindo evento: ${o}`,s),o==="join"&&console.log(`[MockSocket] Usuário ${s} entrou no sistema`)}off(o,s){this.listeners[o]&&(this.listeners[o]=this.listeners[o].filter(c=>c!==s))}disconnect(){this.connected=!1,console.log("[MockSocket] Desconectado")}connect(){this.connected=!0,console.log("[MockSocket] Conectado (modo mock)")}simulateNotification(){const o={_id:`mock_notif_${Date.now()}`,title:"Notificação de Teste",message:"Esta é uma notificação simulada para demonstração.",type:"info",createdAt:new Date().toISOString()};this.listeners.notification&&this.listeners.notification.forEach(s=>{s(o)})}}let t=null;const a=i=>{if(console.log("[MockSocket] Inicializando socket mockado"),t||(t=new n),t.connect(),i){const o=JSON.parse(atob(i.split(".")[1]));t.emit("join",o.userId)}return t},e=()=>(t||(console.warn("[MockSocket] Socket não inicializado"),t=new n),t),r=()=>{t&&(t.disconnect(),t=null)},l=i=>{const o=e();return o.on("notification",i),()=>{o.off("notification",i)}},f=i=>{const o=e();return o.on("message",i),()=>{o.off("message",i)}},k=(i,o)=>{e().emit(o?"typing:start":"typing:stop",{receiverId:i})},d=t;export{d as default,r as disconnectSocket,e as getSocket,a as initSocket,k as sendTypingStatus,f as subscribeToMessages,l as subscribeToNotifications};
